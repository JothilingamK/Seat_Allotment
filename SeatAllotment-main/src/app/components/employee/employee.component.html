<div class="dashboard-container">
    <!-- Sidebar -->
    <div class="sidebar">
        <img src="assets/finzly.svg" alt="logo" height="50px"><br>
        <button [routerLink]="'/'" [class.active]="selectedMenu === 'home'" class="sidebar-btn">
            <i class="bi bi-house-door"></i>
            Home
        </button>
        <button (click)="setMenu('manageEmployee')" [class.active]="selectedMenu === 'manageEmployee'" class="sidebar-btn">
            <i class="bi bi-people"></i>
            Manage Employee
        </button>
    </div>

    <!-- Main Content -->
    <div class="content">

        <!-- Employee Stats Section -->
        <div class="stats-container">
            <div class="stat-card total">
                <div class="stat-icon">
                    <i class="bi bi-people-fill"></i>
                </div>
                <div class="stat-content">
                    <h4>TOTAL EMPLOYEES</h4>
                    <p>{{ employees.length }}</p>
                </div>
            </div>
            <div class="stat-card unassigned">
                <div class="stat-icon">
                    <i class="bi bi-person-x-fill"></i>
                </div>
                <div class="stat-content">
                    <h4>UNASSIGNED</h4>
                    <p>{{ getUnassignedCount() }}</p>
                </div>
            </div>
            <div class="stat-card wfh">
                <div class="stat-icon">
                    <i class="bi bi-house-fill"></i>
                </div>
                <div class="stat-content">
                    <h4>WORK FROM HOME</h4>
                    <p>{{ getWFHCount() }}</p>
                </div>
            </div>
            <div class="stat-card allocated">
                <div class="stat-icon">
                    <i class="bi bi-check-circle-fill"></i>
                </div>
                <div class="stat-content">
                    <h4>ALLOCATED</h4>
                    <p>{{ getAllocatedCount() }}</p>
                </div>
            </div>
        </div>



        <!-- Configuration Section -->
        <div *ngIf="selectedMenu === 'configuration'">
            <h3>Seating Configuration</h3>
            <p>Configure the seating layout and assign desks to employees.</p>
        </div>

        <!-- Manage Employees Section -->
        <div *ngIf="selectedMenu === 'manageEmployee'" class="employee-container">
            <!-- Search Bar & Action Buttons -->
            <div class="action-bar">
                <div class="search-container">
                    <i class="bi bi-search search-icon"></i>
                    <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="onSearchChange()" 
                           placeholder="Search employees..." class="search-input">
                </div>
                <div class="action-buttons">
                    <button class="action-btn primary" (click)="showModal = true">
                        <i class="bi bi-person-plus"></i> Add Employee
                    </button>
                    <button class="action-btn secondary" (click)="generateReport()">
                        <i class="bi bi-file-earmark-pdf"></i> Generate PDF
                    </button>
                    <button class="action-btn secondary" (click)="generateReportExcel()">
                        <i class="bi bi-file-earmark-excel"></i> Generate Excel
                    </button>
                </div>
            </div>


            <!-- Employee Table -->
            <div class="table-container">
                <table class="employee-table">
                    <thead>
                        <tr>
                            <th>EMPLOYEE ID</th>
                            <th>NAME</th>
                            <th>DEPARTMENT</th>
                            <th>ROLE</th>
                            <th>SEAT NO</th>
                            <th>EDIT</th>
                            <th>ACTIONS</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let employee of paginatedEmployees" class="table-row">
                            <td class="employee-id">{{ employee.employeeid }}</td>
                            <td class="employee-name">{{ employee.name }}</td>
                            <td class="employee-dept">{{ employee.department }}</td>
                            <td class="employee-role">{{ employee.role || '-' }}</td>
                            <td class="employee-seat">
                                <span class="seat-badge" [ngClass]="getSeatStatusClass(employee.seat_id)">
                                    {{ employee.seat_id || 'Unassigned' }}
                                </span>
                            </td>
                            <td class="action-cell">
                                <button (click)="editEmployee(employee)" class="action-btn edit" title="Edit Employee">
                                    <i class="bi bi-pencil-square"></i>
                                </button>
                            </td>
                            <td class="action-cell">
                                <button (click)="removeEmployee(employee.employeeid)" class="action-btn delete" title="Delete Employee">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination Controls -->
            <div class="pagination-controls">
                <button class="pagination-btn" (click)="prevPage()" [disabled]="currentPage === 1">
                    <i class="bi bi-chevron-left"></i> Previous
                </button>
                <div class="pagination-info">
                    <span>Page {{ currentPage }} of {{ totalPages() }}</span>
                </div>
                <button class="pagination-btn" (click)="nextPage()" [disabled]="currentPage >= totalPages()">
                    Next <i class="bi bi-chevron-right"></i>
                </button>
            </div>
        </div>

        

         <div class="modal" *ngIf="showModal">
            <div class="modal-content">
                <h2>Add New Employee</h2>

                <div class="form-group">
                    <label>Employee ID:</label>
                    <input [(ngModel)]="newEmployee.employeeid"   class="form-control"required />
                </div>
                <div class="form-group">
                    <label>Name</label>
                    <input [(ngModel)]="newEmployee.name" class="form-control">
                </div>

                <div class="form-group">
                    <label>Department</label>
                    <input [(ngModel)]="newEmployee.department" class="form-control">
                </div>

                <div class="form-group">
                    <label>Role</label>
                    <input [(ngModel)]="newEmployee.role" class="form-control">
                </div>

                <!-- <div class="form-group">
                    <label>Seat No</label>
                    <input [(ngModel)]="newEmployee.seat_id" class="form-control">
                </div> -->

                <div class="form-group seat-selection">
                    <label>Seat No</label>
                    <select [(ngModel)]="newEmployee.seat_id" (change)="handleNewSeatSelection()" class="form-control">
                        <option value="Work From Home">Work From Home</option>
                        <option value="Unassigned">Unassigned</option>
                        <option value="Manual">Manual Entry</option>
                    </select>
                    <!-- Seat selection dropdown -->
                    <select *ngIf="newEmployee.seat_id === 'Manual' && vacantSeats.length > 0"
                        [(ngModel)]="manualNewSeatEntry"
                        class="form-control">
                    <option *ngFor="let seat of vacantSeats" [value]="seat">{{ seat }}</option>
                    </select>

                    <!-- Manual seat input (if no vacant seats are available) -->
                    <input *ngIf="newEmployee.seat_id === 'Manual' && vacantSeats.length === 0"
                    [(ngModel)]="manualNewSeatEntry"
                    class="form-control"
                    placeholder="Enter Seat No">

                    <!-- Message when no vacant seats are available -->
                    <p *ngIf="newEmployee.seat_id === 'Manual' && vacantSeats.length === 0">
                    No vacant seats available. Enter seat manually.
                    </p>

                </div>
                

                <div class="modal-buttons">
                    <button class="submit-btn" (click)="addEmployee()">Submit</button>
                    <button class="close-btn" (click)="showModal = false">Close</button>
                </div>
            </div>
        </div>

<!-- Modal for Editing Employee -->
        <div class="modal" *ngIf="showEditModal">
            <div class="modal-content">
                <h2>Edit Employee</h2>

                <div class="form-group">
                    <label>Name</label>
                    <input [(ngModel)]="selectedEmployee.name" class="form-control">
                </div>

                <div class="form-group">
                    <label>Department</label>
                    <input [(ngModel)]="selectedEmployee.department" class="form-control">
                </div>

                <div class="form-group">
                    <label>Role</label>
                    <input [(ngModel)]="selectedEmployee.role" class="form-control">
                </div>

                <!-- Seat Selection -->
                <div class="form-group seat-selection">
                    <label>Seat No</label>
                    <select [(ngModel)]="selectedEmployee.seat_id" (change)="handleSeatSelection()" class="form-control">
                        <option value="Work From Home">Work From Home</option>
                        <option value="Unassigned">Unassigned</option>
                        <option value="Manual">Manual Entry</option>
                    </select>

                    <!-- Dropdown for vacant seats -->
                    <select *ngIf="selectedEmployee.seat_id === 'Manual' && vacantSeats.length > 0"
                            [(ngModel)]="manualSeatEntry"
                            class="form-control">
                        <option *ngFor="let seat of vacantSeats" [value]="seat">{{ seat }}</option>
                    </select>

                    <!-- Input field for manual seat entry -->
                    <input *ngIf="selectedEmployee.seat_id === 'Manual' && vacantSeats.length === 0"
                        [(ngModel)]="manualSeatEntry"
                        class="form-control"
                        placeholder="Enter Seat No">

                    <!-- Message when no vacant seats are available -->
                    <p *ngIf="selectedEmployee.seat_id === 'Manual' && vacantSeats.length === 0">
                        No vacant seats available. Enter seat manually.
                    </p>
                </div>

                <div class="modal-buttons">
                    <button class="submit-btn" (click)="updateSeat()">Update</button>
                    <button class="close-btn" (click)="showEditModal = false">Close</button>
                </div>

            </div> <!-- This properly closes modal-content -->
        </div> <!-- This properly closes modal -->

        <!-- Confirmation Popup -->
        <div *ngIf="showConfirmation" class="confirmation-popup">
            Employee Added Successfully!
        </div>


       
    </div>
</div>
